## ID: 400003

## HF

## Source: IDS

## Category: Malware

## Description: Heap Overflow Code Execution

## Objective Statement:
Similar to the buffer overflow attack, in this event the attacker used a different method to attack the Windows FTP server. The attacker will be  able to execute system commands, this is very serious.

## Result Analysis:
The attacker is able to over write the heap and is able to place code into the memory of the victim machine and execute code. This code can be crafted to create a shell that gives the attacker command access.  From there the attacker is free to do anything on the system. Investigate the Windows and FTP logs. Investigate the network, firewall and IDS logs. The shell would need to be on a port other than FTP. If the FTP server only uses FTP than this is quite easy task. Other wise investigate for ports blocked by the firewall, or check the traffic of common ports that the firewall would allow. It is possible the attacker used common ports but did not use the service associated with the port.

*References for Futher Learning*
- https://www.rapid7.com/db/modules/exploit/windows/smb/ms08_067_netapi
- https://community.rapid7.com/community/infosec/blog/2014/02/03/new-ms08-067
- https://www.exploit-db.com/exploits/7104/
- https://nmap.org/nsedoc/scripts/smb-vuln-ms08-067.html

## Mitigation
- https://technet.microsoft.com/en-us/library/security/ms08-067.aspx
- There is a patch available for this vulnerability, applying the patch will patch the vulnerability.

## Data Query Code
- Heap overflow code execution
- remote code execution